function modweebChat(e){let t=e.config.hfToken,n=e.config.hfModel,l="modweebChatUsage_v1",i="modweebChatHistory_v1",o="modweebDevUnlimited_v1",r=`
        <button id="modweeb-chat-btn" type="button" class="modweeb-chat-btn" aria-label="ÙØªØ­ Ø§Ù„Ø¯Ø±Ø¯Ø´Ø©" title="Ø§Ø¨Ø¯Ø£ Ø¯Ø±Ø¯Ø´Ø© AI">
            <svg class="modweeb-svg-btn-n" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="1.5" stroke-linecap="round" stroke-linejoin="round">
                <path d="M21.49 12C21.81 10.98 22 9.88 22 8.69C22 5.6 19.51 3.09998 16.44 3.09998C14.62 3.09998 13.01 3.98003 12 5.34003C10.99 3.98003 9.37 3.09998 7.56 3.09998C4.49 3.09998 2 5.6 2 8.69C2 15.69 8.48 19.82 11.38 20.82C11.55 20.88 11.77 20.91 12 20.91"></path>
                <path d="M19.21 15.74L15.67 19.2801C15.53 19.4201 15.4 19.68 15.37 19.87L15.18 21.22C15.11 21.71 15.45 22.05 15.94 21.98L17.29 21.79C17.48 21.76 17.75 21.63 17.88 21.49L21.42 17.95C22.03 17.34 22.32 16.63 21.42 15.73C20.53 14.84 19.82 15.13 19.21 15.74Z" stroke-miterlimit="10"></path>
                <path d="M18.7001 16.25C19.0001 17.33 19.8401 18.17 20.9201 18.47" stroke-miterlimit="10"></path>
            </svg>
        </button>
        <div id="modweeb-widget-container">
            <div id="modweeb-chat-container" role="dialog" aria-label="Ø¯Ø±Ø¯Ø´Ø© Ø§Ù„Ø°ÙƒØ§Ø¡ Ø§Ù„Ø§ØµØ·Ù†Ø§Ø¹ÙŠ">
                <div id="modweeb-status" aria-live="polite"></div>
                <div class="modweeb-head" id="modweeb-head">
                    <span>
                        <svg class="line" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M10.75 2.44995C11.45 1.85995 12.58 1.85995 13.26 2.44995L14.84 3.79995C15.14 4.04995 15.71 4.25995 16.11 4.25995H17.81C18.87 4.25995 19.74 5.12995 19.74 6.18995V7.88995C19.74 8.28995 19.95 8.84995 20.2 9.14995L21.55 10.7299C22.14 11.4299 22.14 12.5599 21.55 13.2399L20.2 14.8199C19.95 15.1199 19.74 15.6799 19.74 16.0799V17.7799C19.74 18.8399 18.87 19.7099 17.81 19.7099H16.11C15.71 19.7099 15.15 19.9199 14.85 20.1699L13.27 21.5199C12.57 22.1099 11.44 22.1099 10.76 21.5199L9.18001 20.1699C8.88001 19.9199 8.31 19.7099 7.92 19.7099H6.17C5.11 19.7099 4.24 18.8399 4.24 17.7799V16.0699C4.24 15.6799 4.04 15.1099 3.79 14.8199L2.44 13.2299C1.86 12.5399 1.86 11.4199 2.44 10.7299L3.79 9.13995C4.04 8.83995 4.24 8.27995 4.24 7.88995V6.19995C4.24 5.13995 5.11 4.26995 6.17 4.26995H7.9C8.3 4.26995 8.86 4.05995 9.16 3.80995L10.75 2.44995Z"></path>
                            <path d="M8.5 15.9401L12 8.06006L15.5 15.9401"></path>
                            <path d="M13.75 13.3101H10.25"></path>
                        </svg>
                        Gemma AI Chat
                    </span>
                    <div style="display:flex;align-items:center;gap:6px">
                        <div class="modweeb-usage" id="modweeb-usage">
                            <span id="modweeb-remaining">Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: --</span>
                            <span id="modweeb-chars">0 Ø£Ø­Ø±Ù</span>
                        </div>
                        <button id="modweeb-chat-close" title="ØºÙ„Ù‚">
                            <svg class="line" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                                <path d="M12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22Z"></path>
                                <path d="M9.16998 14.83L14.83 9.17004"></path>
                                <path d="M14.83 14.83L9.16998 9.17004"></path>
                            </svg>
                        </button>
                    </div>
                </div>
                <div class="modweeb-suggestions" aria-hidden="false">
                    <button class="modweeb-suggestion-btn">ÙƒÙŠÙ Ø£Ø­Ø³Ù† Ø³Ø±Ø¹Ø© Ù…Ø¯ÙˆÙ†ØªÙŠØŸ</button>
                    <button class="modweeb-suggestion-btn">Ù…Ø§ Ø£ÙØ¶Ù„ Ø¥Ø¶Ø§ÙØ§Øª SEOØŸ</button>
                </div>
                <div id="modweeb-messages" aria-live="polite"></div>
                <div class="modweeb-input-wrap">
                    <textarea id="modweeb-input" rows="1" maxlength="300" placeholder="Ø§ÙƒØªØ¨ Ø±Ø³Ø§Ù„ØªÙƒ Ù‡Ù†Ø§..." aria-label="Ù…Ø­ØªÙˆÙ‰ Ø§Ù„Ø±Ø³Ø§Ù„Ø©" style="background:var(--contentB,#fff)"></textarea>
                    <button id="modweeb-send" title="Ø¥Ø±Ø³Ø§Ù„ (Enter)">
                        <svg class="line" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M7.39999 6.32003L15.89 3.49003C19.7 2.22003 21.77 4.30003 20.51 8.11003L17.68 16.6C15.78 22.31 12.66 22.31 10.76 16.6L9.91999 14.08L7.39999 13.24C1.68999 11.34 1.68999 8.23003 7.39999 6.32003Z"></path>
                            <path d="M10.11 13.6501L13.69 10.0601"></path>
                        </svg>
                    </button>
                </div>
                <div class="modweeb-actions">
                    <button id="modweeb-copy-all" title="Ù†Ø³Ø® Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©">
                        <svg class="line" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 22C6.48 22 2 17.52 2 12C2 6.48 6.48 2 12 2C17.52 2 22 6.48 22 12C22 17.52 17.52 22 12 22Z"></path>
                            <path d="M14.88 15C14.17 15.62 13.25 16 12.24 16C10.03 16 8.23999 14.21 8.23999 12C8.23999 9.79 10.03 8 12.24 8C13.25 8 14.17 8.38 14.88 9"></path>
                        </svg>
                    </button>
                    <button id="modweeb-clear" title="Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©">
                        <svg class="line" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                            <path d="M12 22C17.5 22 22 17.5 22 12C22 6.5 17.5 2 12 2C6.5 2 2 6.5 2 12C2 17.5 6.5 22 12 22Z"></path>
                            <path d="M9.16998 14.83L14.83 9.17004"></path>
                            <path d="M14.83 14.83L9.16998 9.17004"></path>
                        </svg>
                    </button>
                </div>
            </div>
        </div>
    `,a=document.createElement("div");for(a.innerHTML=r;a.firstChild;)document.body.appendChild(a.firstChild);let s=document.getElementById("modweeb-chat-btn"),_=document.getElementById("modweeb-chat-container"),d=document.getElementById("modweeb-messages"),c=document.getElementById("modweeb-status"),p=document.getElementById("modweeb-input"),u=document.getElementById("modweeb-send"),m=document.getElementById("modweeb-chat-close"),$=document.getElementById("modweeb-chars"),b=document.getElementById("modweeb-head"),h=document.getElementById("modweeb-copy-all"),g=document.getElementById("modweeb-clear"),y=document.querySelectorAll(".modweeb-suggestion-btn");function v(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;"):""}function f(e){try{let t=new URL(e,location.href);return"https:"===t.protocol||"http:"===t.protocol}catch(n){return!1}}function w(e){let t=v(e);t=t.replace(/^#{1,6}\s+(.*)$/gm,(e,t)=>`<b style="display:block; margin:15px 0 8px 0; color:var(--linkC, #2563eb);">${t.trim()}</b>`);let n=0;return(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=(t=t.replace(/^[*\-]\s+(.*)$/gm,(e,t)=>`${++n<=10?["Ù¡","Ù¢","Ù£","Ù¤","Ù¥","Ù¦","Ù§","Ù¨","Ù©","Ù¡Ù "][n-1]:n+"."} ${t.trim()}<br>`)).replace(/(?<!\w)[*#](?!\w)/g,"")).replace(/\*\*/g,"")).replace(/\*/g,"")).replace(/!\[([^\]]*?)\]\((.*?)\)/g,(e,t,n)=>f(n.trim())?`<img src="${n.trim()}" alt="${v(t)}" loading="lazy" style="max-width:100%; height:auto; border-radius:8px; margin:8px 0;">`:v(e))).replace(/\[([^\]]+)\]\((.*?)\)/g,(e,t,n)=>f(n.trim())?`<a href="${n.trim()}" target="_blank" rel="noopener noreferrer" style="color:var(--linkC, #2563eb); text-decoration:underline;">${v(t)}</a>`:v(e))).replace(/`([^`]+)`/g,(e,t)=>`<code style="background:var(--contentBa, #f4f8ff); padding:2px 6px; border-radius:4px; border:1px solid var(--contentL, #e3e7ef);">${v(t)}</code>`)).replace(/\*\*(.*?)\*\*/g,(e,t)=>`<b style="font-weight:600;">${v(t)}</b>`)).replace(/\*(.*?)\*/g,(e,t)=>`<i style="font-style:italic;">${v(t)}</i>`)).replace(/(^|\s)(https?:\/\/\S+\.(?:png|jpe?g|gif|webp|bmp))(?![^<]*>)/gi,(e,t,n)=>f(n)?`${t}<img src="${n}" loading="lazy" style="max-width:100%; height:auto; border-radius:8px; margin:8px 0;">`:e)).replace(/(^|\s)(https?:\/\/[^\s<]+)/g,(e,t,n)=>f(n)?`${t}<a href="${n}" target="_blank" rel="noopener noreferrer" style="color:var(--linkC, #2563eb); text-decoration:underline;">${v(n)}</a>`:e)).replace(/\n\n+/g,"<br><br>")).replace(/\n/g,"<br>")).replace(/(<br>){3,}/g,"<br><br>")}function C(){try{let e=localStorage.getItem(l);if(!e)return k();let t=JSON.parse(e),n=new Date().toISOString().slice(0,10);if(t.date!==n)return k();return t}catch(i){return k()}}function k(){let e={date:new Date().toISOString().slice(0,10),count:0,limit:25};return localStorage.setItem(l,JSON.stringify(e)),e}function x(){let e=function e(){if("1"===localStorage.getItem(o))return 1/0;let t=C();return Math.max(0,t.limit-t.count)}();document.getElementById("modweeb-remaining").textContent=e===1/0?"ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯":`Ø§Ù„Ø±Ø³Ø§Ø¦Ù„ Ø§Ù„Ù…ØªØ¨Ù‚ÙŠØ©: ${e}`}let L=!1;function E(){try{let e=[...d.children].map(e=>({role:e.classList.contains("modweeb-msg-user")?"user":"assistant",html:e.querySelector(".bubble")?e.querySelector(".bubble").innerHTML:e.innerHTML}));localStorage.setItem(i,JSON.stringify(e))}catch(t){}}function M(){try{let e=localStorage.getItem(i);if(!e)return;let t=JSON.parse(e);d.innerHTML="",t.forEach(e=>{let t=document.createElement("div");"user"===e.role?t.className="modweeb-msg-user":t.className="modweeb-msg-ai";let n=document.createElement("div");if(n.className="bubble",n.innerHTML=e.html,t.appendChild(n),"assistant"===e.role){let l=document.createElement("div"),l=document.createElement("div");l.className="modweeb-controls-top",l.innerHTML=`<button class="copy-reply" title="Ù†Ø³Ø® Ø§Ù„Ø±Ø¯">
        <svg fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path d="M16 4h2a2 2 0 012 2v14a2 2 0 01-2 2H6a2 2 0 01-2-2V6a2 2 0 012-2h2"></path><rect width="10" height="10" x="8" y="2" rx="2"></rect></svg>
      </button>`,t.appendChild(l)}d.appendChild(t)}),L=!0,setTimeout(()=>{d.scrollTop=d.scrollHeight},100)}catch(n){}}function H(e,t=1600){c.style.display="block",c.textContent=e,t>0&&setTimeout(()=>{c.style.display="none"},t)}function T(){let e=document.createElement("div");e.className="modweeb-msg-ai";let t=document.createElement("div");t.className="bubble",t.innerHTML=`<div style="display:flex;align-items:center;gap:8px;"><div class="spinner" aria-hidden="true"></div> Ø¬Ø§Ø±ÙŠ Ø§Ù„ÙƒØªØ§Ø¨Ø©...</div>`,e.appendChild(t);let n=document.createElement("div");return n.className="meta",n.innerHTML=`<div class="msg-controls">
        <button class="copy-reply" title="Ù†Ø³Ø® Ø§Ù„Ø±Ø¯">Ù†Ø³Ø®</button>
        <button class="resend-retry" title="Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©" style="display:none">Ø¥Ø¹Ø§Ø¯Ø©</button>
      </div>`,e.appendChild(n),d.appendChild(e),d.scrollTop=d.scrollHeight,e}async function I(e,i=null,r=!1){var a,s;if("1"!==localStorage.getItem(o)){let _=C();if(_.count>=_.limit)return H("ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ø±Ø³Ø§Ø¦Ù„"),!1}let c=i||T();H("Ø¬Ø§Ø±ÙŠ Ø¥Ø±Ø³Ø§Ù„ Ø§Ù„Ø±Ø³Ø§Ù„Ø©..."),q("chat_message_sent");let p,u,m=(a=e,p=[...d.children],u=[{role:"system",content:"Ø£Ù†Øª Ù…Ø³Ø§Ø¹Ø¯ ØªÙ‚Ù†ÙŠ Ù„Ù…Ø¯ÙˆÙ†Ø© modweeb.comØŒ Ø£Ø¬ÙØ¨ Ø¨Ø´ÙƒÙ„ Ù…Ø®ØªØµØ± ÙˆØ¹Ù…Ù„ÙŠ ÙˆØ§Ø­ØªØ±Ø§ÙÙŠ."}],p.forEach(e=>{let t=e.classList.contains("modweeb-msg-user"),n=e.querySelector(".bubble");if(!n)return;let l=n.innerText||n.textContent||"";u.push({role:t?"user":"assistant",content:l})}),a&&u.push({role:"user",content:a}),u);try{let $=await fetch("https://router.huggingface.co/v1/chat/completions",{method:"POST",headers:{Authorization:`Bearer ${t}`,"Content-Type":"application/json"},body:JSON.stringify({model:n,messages:m,max_tokens:1e3,temperature:.7,top_p:.9})});if(!$.ok)throw Error("network");let b=await $.json(),h=b?.choices?.[0]?.message?.content||"âŒ Ø­Ø¯Ø« Ø®Ø·Ø£.",g=w(h),y=c.querySelector(".bubble");y&&(y.innerHTML=g);let v=c.querySelector(".resend-retry");v&&(v.style.display="none");let f=C();return f.count=(f.count||0)+1,s=f,localStorage.setItem(l,JSON.stringify(s)),x(),E(),H("ØªÙ… Ø§Ù„Ø±Ø¯ Ø¨Ù†Ø¬Ø§Ø­!"),q("chat_message_received",{tokens:b?.usage?.total_tokens||0}),!0}catch(k){let L=c.querySelector(".bubble");L&&(L.innerHTML=`<div style="color:#ef4444;">âŒ ØªØ¹Ø°Ø± Ø§Ø³ØªØ¬Ø§Ø¨Ø© Ø§Ù„Ù…Ø³Ø§Ø¹Ø¯</div>`);let M=c.querySelector(".resend-retry");return M&&(M.style.display="inline-block",M.onclick=async function(){M.disabled=!0,M.textContent="...",L.innerHTML=`<div style="display:flex;align-items:center;gap:8px;"><div class="spinner"></div> Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©...</div>`,await I(e,c,!0),M.disabled=!1,M.textContent="Ø¥Ø¹Ø§Ø¯Ø©"}),E(),H("ØªØ¹Ø°Ø± Ø§Ù„Ø§ØªØµØ§Ù„ Ø¨Ø§Ù„Ø®Ø§Ø¯Ù…"),!1}}function B(){if(!L){let e=document.createElement("div");e.className="modweeb-msg-ai";let t=document.createElement("div");t.className="bubble",t.innerHTML=`ğŸ‘‹ Ù…Ø±Ø­Ø¨Ù‹Ø§ Ø¨Ùƒ ÙÙŠ Ø¯Ø±Ø¯Ø´Ø© <b>modweeb.com</b>! ÙƒÙŠÙ Ø£Ø³Ø§Ø¹Ø¯ÙƒØŸ`,e.appendChild(t);let n=document.createElement("div");n.className="meta",n.innerHTML=`<div class="msg-controls"><button class="copy-reply" title="Ù†Ø³Ø® Ø§Ù„Ø±Ø¯">Ù†Ø³Ø®</button></div>`,e.appendChild(n),d.appendChild(e),L=!0,q("chat_opened"),setTimeout(()=>{d.scrollTop=d.scrollHeight},100)}}s.onclick=function(){_.style.display="flex",_.style.position="fixed",_.style.left="",_.style.top="",_.style.right="32px",_.style.bottom="142px",B(),setTimeout(function(){p.focus()},100),window.modweebChatOpenedAt=Date.now(),x(),M()},m.onclick=function(){_.style.display="none",_.style.position="fixed",_.style.left="",_.style.top="",_.style.right="32px",_.style.bottom="142px",window.modweebChatOpenedAt&&q("chat_duration",{value:Date.now()-window.modweebChatOpenedAt})},p.addEventListener("input",function(e){e.target.style.height="auto",e.target.style.height=Math.min(e.target.scrollHeight,62)+"px",$.textContent=`${e.target.value.length} Ø£Ø­Ø±Ù`}),p.addEventListener("keydown",function(e){if("Enter"===e.key&&!e.shiftKey||(e.ctrlKey||e.metaKey)&&"Enter"===e.key){e.preventDefault(),u.click();return}if("ArrowUp"===e.key&&""===p.value.trim()){let t=[...d.children].reverse().find(e=>e.classList.contains("modweeb-msg-user"));if(t){let n=t.querySelector(".bubble").innerText||"";p.value=n,p.dispatchEvent(new Event("input"))}}}),document.addEventListener("keydown",function(e){"Escape"===e.key&&(_.style.display="none"),(e.ctrlKey||e.metaKey)&&"k"===e.key.toLowerCase()&&(e.preventDefault(),_.style.display="flex",setTimeout(()=>p.focus(),100))}),y.forEach(e=>{e.onclick=()=>{p.value=e.textContent,p.focus(),p.dispatchEvent(new Event("input"))}}),h.onclick=function(){let e=[...d.children].map(e=>e.innerText).join("\n");navigator.clipboard.writeText(e).then(()=>H("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©!"))},g.onclick=function(){localStorage.removeItem(i),d.innerHTML="",L=!1,B(),H("ØªÙ… Ø­Ø°Ù Ø§Ù„Ù…Ø­Ø§Ø¯Ø«Ø©!")},d.addEventListener("click",function(e){let t=e.target;if(t.closest(".copy-reply")){let n=t.closest(".modweeb-msg-ai");if(!n)return;let l=n.querySelector(".bubble").innerText||"";navigator.clipboard.writeText(l).then(()=>H("ØªÙ… Ù†Ø³Ø® Ø§Ù„Ø±Ø¯!"))}if(t.closest(".edit-user")){let i=t.closest(".modweeb-msg-user");if(!i)return;let o=i.querySelector(".bubble").innerText||"";p.value=o,p.focus(),p.dispatchEvent(new Event("input"))}}),u.onclick=async function(){var e;let t=p.value.trim();if(!t)return;if("1"!==localStorage.getItem(o)){let n=C();if(n.count>=n.limit){H("ØªÙ… ØªØ¬Ø§ÙˆØ² Ø§Ù„Ø­Ø¯ Ø§Ù„ÙŠÙˆÙ…ÙŠ Ù„Ù„Ø±Ø³Ø§Ø¦Ù„");return}}let l,i,r;e=t,(l=document.createElement("div")).className="modweeb-msg-user",(i=document.createElement("div")).className="modweeb-controls-top",i.innerHTML=`<button class="edit-user" title="ØªØ¹Ø¯ÙŠÙ„">
        <svg fill="none" stroke="currentColor" stroke-width="1.5" viewBox="0 0 24 24"><path d="M12 20h9"></path><path d="M16.5 3.5l4 4L7 20H3v-4L16.5 3.5z"></path></svg>
      </button>`,l.appendChild(i),(r=document.createElement("div")).className="bubble",r.innerHTML=w(e),l.appendChild(r),d.appendChild(l),p.value="",p.style.height="auto",$.textContent=`0 Ø£Ø­Ø±Ù`;let a=T();d.scrollTop=d.scrollHeight,E(),await I(t,a)},M(),x();let S=0,N=null;function q(e,t){window.gtag&&gtag("event",e,t||{})}function j(){let e=window.visualViewport.height;window.innerHeight-e>150?(_.style.bottom="10px",s.style.bottom="10px"):(_.style.bottom="142px",s.style.bottom="88px")}b.addEventListener("click",function(e){if(S++,N&&clearTimeout(N),N=setTimeout(()=>{S=0},4e3),S>=5){S=0;"1"===localStorage.getItem(o)?(localStorage.removeItem(o),H("ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø·ÙˆØ± Ù…Ø¹Ø·Ù„")):(localStorage.setItem(o,"1"),H("ÙˆØ¶Ø¹ Ø§Ù„Ù…Ø·ÙˆØ± Ù…ÙØ¹Ù„: ØºÙŠØ± Ù…Ø­Ø¯ÙˆØ¯")),x()}}),d.style.minHeight="60px",window.visualViewport.addEventListener("resize",j),window.visualViewport.addEventListener("scroll",j),document.addEventListener("click",function(e){"flex"!==_.style.display||_.contains(e.target)||s.contains(e.target)||(_.style.display="none")})}
